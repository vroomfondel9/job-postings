<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Postings</title>
<style>
body {
  background: #f2f2f7;
  font-family: "Segoe UI", Roboto, sans-serif;
  color: #222;
  margin: 0;
  padding: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.5rem;
}

.card {
  background: #fff;
  width: 96%;
  border-radius: 16px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  position: relative;
  overflow: hidden;
  padding: 1rem 1.5rem 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.card-actions {
  width: 100%;
  display: flex;
  justify-content: center; /* <-- now centered */
  gap: 1rem;
  margin-top: 1rem;
}

.card-actions .action-btn {
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  border: 1px solid #aaa;
  cursor: pointer;
  transition: background 0.2s;
  font-size: 0.85rem;
  background: green;
  color: white;
}

.card-actions .action-btn:hover {
  background: #006400;
}

#overlay-notes {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

#overlay-notes .notes-box {
  background: #fff;
  padding: 1.5rem;
  border-radius: 12px;
  width: 400px;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

#overlay-notes textarea {
  width: 95%;
  height: 150px;
  padding: 0.5rem;
  font-size: 0.9rem;
}

#overlay-notes .notes-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
}


.top-section {
  position: relative;
  width: 100%;
  height: 80px;
}

.circle {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: 600;
  color: black;
  font-size: 0.9rem;
  position: absolute;
  top: 0;
}

.location-circle { left: 0; }
.match-circle { right: 0; }

.salary-ruler {
  position: absolute;
  top: 25px;
  left: 85px;
  right: 85px;
  height: 30px;
  border-top: 2px solid #999;
}

.salary-ruler::before, .salary-ruler::after {
  content: '';
  position: absolute;
  height: 2px;
  background: #333;
  top: 0;
}

.salary-ruler .mark {
  position: absolute;
  width: 1px;
  top: -5px;
  height: 10px;
  background: #aaa;
}

.salary-ruler .mark.major {
  height: 16px;
  background: #555;
}

.salary-ruler .label {
  position: absolute;
  top: 18px;
  transform: translateX(-50%);
  font-size: 10px;
  color: #333;
}

.salary-range {
  position: absolute;
  top: 0;
  height: 4px;
  background: linear-gradient(to right, rgba(255,0,0,0.4) 0 50%, rgba(0,200,0,0.4) 50% 100%);
  border-radius: 2px;
}

.middle-section {
  display: grid;
  grid-template-columns: 96px 1fr 96px;
  align-items: center;
  margin-top: 1rem;
  margin-bottom: 1rem;
  width: 100%;
}

.center-info {
  text-align: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 0.2rem;
}

.center-info div {
  font-size: 1rem;
  font-weight: 500;
}

.language-header {
  position: absolute;
  top: -1.2rem;  /* slightly above the top ruler */
  font-weight: 700;
  font-size: 0.85rem;
  color: #000;
  width: 100%;
  text-align: center;
}

.language-ruler.left .language-header {
  left: 0;   /* aligns to the left column edge */
}

.language-ruler.right .language-header {
  right: 0;  /* aligns to the right column edge */
}


.language-ruler {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 140px;
  position: relative;
  font-size: 0.8rem;
  color: #000;
}

.language-ruler.left {
  align-items: flex-start;
  text-align: left;
}

.language-ruler.right {
  align-items: flex-end;
  text-align: right;
}

.language-ruler .label {
  position: relative;
  width: 100%;
}

.language-ruler.left::before, .language-ruler.right::before {
  content: '';
  position: absolute;
  top: 0; bottom: 0;
  width: 1px;
  background: #aaa;
}

.language-ruler.left::before { right: 0; }
.language-ruler.right::before { left: 0; }

.language-ruler .label::after {
  content: '';
  position: absolute;
  top: 50%;
  width: 6px;
  height: 1px;
  background: #aaa;
}

.language-ruler.left .label::after { right: -6px; }
.language-ruler.right .label::after { left: -6px; }

.triangle {
  width: 0;
  height: 0;
  position: absolute;
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
}

.language-ruler.left .triangle {
  border-left: 8px solid transparent;
  border-right: 8px solid green;
  right: -9px;
}

.language-ruler.right .triangle {
  border-right: 8px solid transparent;
  border-left: 8px solid green;
  left: -9px;
}

.bottom-techs {
  width: 100%;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  font-size: 0.85rem;
  gap: 0.6rem;
  margin-top: 1rem;
}

.tech {
  font-weight: 600;
}

.accordion {
  width: 100%;
  max-width: 900px;  /* choose width that fits your cards */
  border-radius: 12px;
  overflow: hidden;
  background: #fff;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  margin: 0 auto;
}


.accordion-header {
  padding: 1rem;
  font-weight: 600;
  background: #e0e0e5;
  cursor: pointer;
}

.accordion-content {
  padding: 1rem 0;
  display: none;
}

.accordion-section {
  width: 800px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  overflow: hidden;
}

.accordion-header {
  padding: 1rem;
  font-size: 1.2rem;
  font-weight: 600;
  cursor: pointer;
  background: #e5e5ea;
}

.accordion-content {
  padding: 1rem;
  display: none;
}

.accordion-section {
  width: 100%;
  max-width: 900px; /* or whatever width matches your card layout */
  margin: 0 auto;   /* center it */
}

.accordion-content {
  width: 100%;
}

.card {
  box-sizing: border-box;
}

.accordion-header {
  width: 100%;
  box-sizing: border-box;
}

.bottom-section {
  position: relative;
  width: 100%;
  height: 80px; /* adjust height as needed */
  display: flex;
  justify-content: space-between; /* or center items */
  align-items: center;
  gap: 1rem;
}


.age-circle {
  position: absolute; 
  left: 0; 
  top: 50%;
  transform: translateY(-50%);
}







</style>
</head>
<body>
<h1 style="margin:0;">Job Listings</h1>
<h3 id="timestamp-subheading" style="margin-top:-0.5rem; font-weight:400; color:#444;">
  as of ...
</h3>

<div class="accordion">
  <div class="accordion-header" data-target="section-ready">
    Ready For Review
  </div>
  <div class="accordion-content" id="section-ready" style="display: block;"></div>
</div>

<div class="accordion">
  <div class="accordion-header" data-target="section-waiting">
    Waiting
  </div>
  <div class="accordion-content" id="section-waiting" style="display: none;"></div>
</div>

<div class="accordion">
  <div class="accordion-header" data-target="section-dismissed">
    Dismissed
  </div>
  <div class="accordion-content" id="section-dismissed" style="display: none;"></div>
</div>


<div id="overlay-notes">
  <div class="notes-box">
    <textarea id="notes-textarea"></textarea>
    <div class="notes-buttons">
      <button id="save-note">Save</button>
      <button id="cancel-note">Cancel</button>
    </div>
  </div>
</div>
<script>
const generationTimestamp = new Date("2025-11-20T16:52:41.243Z"); //Replace this line with Generation Date
const jobPostings = [
  {
    "id": 1,
    "llm_match_percent": 35,
    "llm_short_title": "Engineering Manager",
    "llm_short_duty": "Managing platform and application development teams",
    "llm_short_company_type": "Manufacturing AI Data Platform",
    "llm_remote_percentage": 20,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/caddi/caddi-engineering-manager-id5a0w",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Conversational",
    "salary_max": 14000000,
    "salary_min": 10000000,
    "createdAt": "\"2025-11-05T02:05:49.561Z\"",
    "updatedAt": "\"2025-11-20T15:21:52.496Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "Rust": 0,
      "React": 0,
      "Typescript": 0,
      "Kubernetes": 0,
      "PostgreSQL": 0,
      "gRPC": 0,
      "GraphQL": 0
    }
  },
  {
    "id": 2,
    "llm_match_percent": 52,
    "llm_short_title": "Site Reliability Engineer",
    "llm_short_duty": "Running AWS/Kubernetes platforms and automating infrastructure",
    "llm_short_company_type": "Sales & Marketing SaaS",
    "llm_remote_percentage": 60,
    "remote_partial": true,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/sales-marker/sales-marker-site-reliability-engineer-h990f1",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 12000000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:05:49.561Z\"",
    "updatedAt": "\"2025-11-20T15:21:52.517Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Kubernetes": 1,
      "AWS": 1,
      "Terraform": 0,
      "Datadog": 0,
      "Go": 0,
      "Python": 1,
      "Java": 4,
      "Docker": 2,
      "Git": 4
    }
  },
  {
    "id": 3,
    "llm_match_percent": 5,
    "llm_short_title": "Senior Product Manager",
    "llm_short_duty": "Managing AI-driven software test automation products",
    "llm_short_company_type": "AI software testing startup",
    "llm_remote_percentage": 0,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/autify/autify-senior-product-manager---er38s8",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Business",
    "salary_max": 15000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:05:49.561Z\"",
    "updatedAt": "\"2025-11-20T15:25:17.616Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {}
  },
  {
    "id": 61,
    "llm_match_percent": 15,
    "llm_short_title": "Ruby on Rails Engineer",
    "llm_short_duty": "Building web applications with Ruby on Rails",
    "llm_short_company_type": "Business & IT Consulting",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/scoville/scoville-experienced-ruby-on-rails-engineer-1h808e",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Business",
    "salary_max": 13000000,
    "salary_min": 9000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-20T15:25:17.639Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Ruby on Rails": 0,
      "Ruby": 0,
      "JavaScript": 2,
      "TypeScript": 0,
      "HTML": 4,
      "CSS": 3,
      "Docker": 2
    }
  },
  {
    "id": 62,
    "llm_match_percent": 5,
    "llm_short_title": "Product Designer",
    "llm_short_duty": "designing user experiences for AI products",
    "llm_short_company_type": "Business creation / AI startup",
    "llm_remote_percentage": 50,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/scoville/scoville-experienced-product-designer-ai-lufdw5",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-20T15:25:17.658Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Figma": 0,
      "Sketch": 0,
      "Adobe XD": 0
    }
  },
  {
    "id": 63,
    "llm_match_percent": 65,
    "llm_short_title": "Full-Stack Engineer",
    "llm_short_duty": "Building evaluation and training platforms",
    "llm_short_company_type": "HRTech",
    "llm_remote_percentage": 80,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery--full-stack-engineer-3dk85k",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 8500000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-13T04:01:04.069Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Node.js": 2,
      "React": 2,
      "Typescript": 0,
      "PostgreSQL": 2,
      "HTML": 4,
      "CSS": 3,
      "SQL": 2,
      "AWS": 0
    }
  },
  {
    "id": 64,
    "llm_match_percent": 78,
    "llm_short_title": "Full-stack Developer",
    "llm_short_duty": "building AI-driven interview tools",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery--full-stack-engineer--ai-interview-f83ef8",
    "source": "Japan Dev",
    "language_en": "None",
    "language_jp": "Fluent",
    "salary_max": 9000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-13T04:00:57.959Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "React": 0,
      "TypeScript": 0,
      "AWS": 0,
      "Git": 4,
      "JIRA": 4,
      "HTML": 4,
      "CSS": 3,
      "JavaScript": 3
    }
  },
  {
    "id": 65,
    "llm_match_percent": 78,
    "llm_short_title": "Full-stack Engineer",
    "llm_short_duty": "Building AI-powered HR tools",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-aihr-tech-v0o456",
    "source": "Japan Dev",
    "language_en": "None",
    "language_jp": "Fluent",
    "salary_max": 9000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-08T05:14:03.289Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "TypeScript": 0
    }
  },
  {
    "id": 66,
    "llm_match_percent": 70,
    "llm_short_title": "Backend Engineer",
    "llm_short_duty": "building REST APIs in Scala",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-backend-engineer-scala-nruzwd",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 9500000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-20T15:30:45.028Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Scala": 0,
      "PostgreSQL": 2,
      "Docker": 2,
      "AWS": 0,
      "Redis": 0,
      "React": 0,
      "TypeScript": 0,
      "Terraform": 0
    }
  },
  {
    "id": 67,
    "llm_match_percent": 45,
    "llm_short_title": "Rails Engineer",
    "llm_short_duty": "developing real-estate web services",
    "llm_short_company_type": "PropTech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/spacely/spacely-rails-engineer-1dc4i4",
    "source": "Japan Dev",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 10000000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-20T15:30:45.048Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Ruby": 0,
      "Ruby on Rails": 0,
      "JavaScript": 2,
      "HTML": 4,
      "CSS": 2,
      "MySQL": 2,
      "PostgreSQL": 0,
      "RSpec": 0,
      "AWS": 0,
      "Vue.js": 0,
      "React.js": 0,
      "Elasticsearch": 0,
      "OpenAPI": 0
    }
  },
  {
    "id": 68,
    "llm_match_percent": 70,
    "llm_short_title": "Senior Frontend Engineer",
    "llm_short_duty": "Building B2B SaaS groupware/identity access management UIs",
    "llm_short_company_type": "Cloud collaboration",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/cybozu/cybozu-senior-frontend-engineer-f04kas",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Conversational",
    "salary_max": 12000000,
    "salary_min": 10000000,
    "createdAt": "\"2025-11-05T02:05:56.365Z\"",
    "updatedAt": "\"2025-11-20T15:35:47.448Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "TypeScript": 0,
      "React": 2,
      "gRPC": 0,
      "OAuth 2": 0,
      "CI/CD": 0
    }
  },
  {
    "id": 88,
    "llm_match_percent": 5,
    "llm_short_title": "Windows Internals Engineer",
    "llm_short_duty": "Building low-level Windows kernel drivers and endpoint security sensors",
    "llm_short_company_type": "Cyber-security",
    "llm_remote_percentage": 50,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/cybereason/cybereason-senior-windows-internals-engineer-qopf06",
    "source": "Japan Dev",
    "language_en": "Fluent",
    "language_jp": "None",
    "salary_max": 15000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:05:56.369Z\"",
    "updatedAt": "\"2025-11-20T15:35:47.469Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "C++": 0,
      "Windows Internals": 0,
      "Kernel Drivers": 0,
      "WinDbg": 0,
      "Windows Filtering Platform": 0,
      "ETW": 0,
      "Visual Studio": 0,
      "Windows Driver Kit": 0,
      "PowerShell": 0,
      "Python": 1
    }
  },
  {
    "id": 121,
    "llm_match_percent": 42,
    "llm_short_title": "R&D Engineer",
    "llm_short_duty": "Building 3D/AI features from panoramic images",
    "llm_short_company_type": "Real-estate SaaS",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/spacely/spacely-rd-engineermanager-9jqqga",
    "source": "Japan Dev",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 7500000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-20T15:35:47.492Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "Typescript": 0,
      "WebGL": 0,
      "ML": 0
    }
  },
  {
    "id": 122,
    "llm_match_percent": 35,
    "llm_short_title": "Founding Engineer",
    "llm_short_duty": "Building voice/ambient-AI web products",
    "llm_short_company_type": "AI startup",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/alenx/alenx-founding-engineer-cto-candidate-vibzd3",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 25000000,
    "salary_min": 20000000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-20T15:40:47.984Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "TypeScript": 0,
      "React": 0,
      "React Router v7": 0,
      "Vite": 0,
      "Vitest": 0,
      "Playwright": 0,
      "pnpm": 0,
      "Cloudflare": 0,
      "Turso": 0
    }
  },
  {
    "id": 123,
    "llm_match_percent": 42,
    "llm_short_title": "Frontend Engineer",
    "llm_short_duty": "Building React/Next.js interfaces for an AI healthcare platform",
    "llm_short_company_type": "HealthTech",
    "llm_remote_percentage": 100,
    "remote_partial": true,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/sind/sind-frontend-engineer-web-ctt62c",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Conversational",
    "salary_max": 8400000,
    "salary_min": 3600000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-13T02:56:30.812Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "React": 2,
      "Next.js": 0,
      "TypeScript": 0,
      "Tailwind CSS": 0,
      "HTML": 4,
      "CSS": 3,
      "JavaScript": 3,
      "Grafana": 0
    }
  },
  {
    "id": 124,
    "llm_match_percent": 55,
    "llm_short_title": "Site Reliability Engineer",
    "llm_short_duty": "Building and automating cloud infrastructure",
    "llm_short_company_type": "AI software testing",
    "llm_remote_percentage": 80,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/autify/autify-senior-site-reliability-engineer-bnqnqq",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 10000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-20T15:40:48.003Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "AWS": 0,
      "Google Cloud": 0,
      "Terraform": 0,
      "Golang": 0,
      "Python": 1,
      "Kubernetes": 0,
      "Docker": 2,
      "PostgreSQL": 0,
      "Ruby": 0,
      "JavaScript": 2,
      "TypeScript": 0,
      "React": 0,
      "Git": 4,
      "Jenkins": 4,
      "CircleCI": 0,
      "GitHub Actions": 0
    }
  },
  {
    "id": 125,
    "llm_match_percent": 12,
    "llm_short_title": "UI/UX Design Lead",
    "llm_short_duty": "Leading design teams and designing HR assessment web platforms",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-hr-tech-uiux-design-lead-54tfdd",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 10200000,
    "salary_min": 8400000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-13T02:56:09.987Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {}
  },
  {
    "id": 126,
    "llm_match_percent": 73,
    "llm_short_title": "Backend-focused Full-Stack Engineer",
    "llm_short_duty": "Architecting and delivering new B2B/B2C cloud products",
    "llm_short_company_type": "Manufacturing AI SaaS",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/caddi/caddi-senior-software-engineer-backend---english-i6b8nk",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "Conversational",
    "salary_max": 12000000,
    "salary_min": 8500000,
    "createdAt": "\"2025-11-05T02:06:03.894Z\"",
    "updatedAt": "\"2025-11-20T15:45:48.024Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Docker": 2,
      "Node.js": 0,
      "TypeScript": 0,
      "React": 0,
      "Kubernetes": 0,
      "GraphQL": 0,
      "REST": 2,
      "gRPC": 0,
      "PostgreSQL": 0,
      "Git": 4,
      "Jenkins": 4,
      "Java": 4,
      "Spring Framework": 4
    }
  },
  {
    "id": 181,
    "llm_match_percent": 29,
    "llm_short_title": "Senior Machine Learning Engineer",
    "llm_short_duty": "building LLM-based QA automation",
    "llm_short_company_type": "AI/Software Testing",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/autify/autify-senior-machine-learning-engineer-llms--prompt-engineering-new-project-dhvizi",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 12000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:06:10.033Z\"",
    "updatedAt": "\"2025-11-08T05:14:03.289Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "PyTorch": 1,
      "Kubernetes": 0,
      "GPT-4": 0,
      "FastAPI": 0,
      "Docker": 2,
      "PostgreSQL": 0,
      "Selenium": 1,
      "Git": 4
    }
  },
  {
    "id": 182,
    "llm_match_percent": 25,
    "llm_short_title": "Salesforce Developer",
    "llm_short_duty": "building Salesforce/Agentforce solutions",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-salesforceagentforce-nut8fl",
    "source": "Japan Dev",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 10200000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:06:10.033Z\"",
    "updatedAt": "\"2025-11-20T15:45:48.045Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Salesforce": 0,
      "Apex": 0,
      "Visualforce": 0,
      "Lightning": 0,
      "Agentforce": 0,
      "Einstein": 0
    }
  },
  {
    "id": 241,
    "llm_match_percent": 25,
    "llm_short_title": "Engineering Manager",
    "llm_short_duty": "Leading infrastructure/DevOps teams and driving IaC automation",
    "llm_short_company_type": "HRTech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery--site-reliability-engineer-6jsdyi",
    "source": "Japan Dev",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:06:17.985Z\"",
    "updatedAt": "\"2025-11-20T15:21:48.686Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Terraform": 1,
      "AWS": 0,
      "Docker": 2
    }
  },
  {
    "id": 242,
    "llm_match_percent": 45,
    "llm_short_title": "QA Consultant",
    "llm_short_duty": "advising clients on test automation and quality issues",
    "llm_short_company_type": "AI software testing",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-engineering-manager-infrastructure-9yk3ew",
    "source": "Japan Dev",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:06:17.985Z\"",
    "updatedAt": "\"2025-11-20T15:21:48.706Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Selenium": 1
    }
  },
  {
    "id": 243,
    "llm_match_percent": 35,
    "llm_short_title": "QA Consultant",
    "llm_short_duty": "advising clients on test automation and quality assurance",
    "llm_short_company_type": "AI software testing",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/autify/autify-qa-consultant-kcplts",
    "source": "Japan Dev",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 10000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:17.985Z\"",
    "updatedAt": "\"2025-11-20T15:21:48.726Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Selenium": 1
    }
  },
  {
    "id": 285,
    "llm_match_percent": 92,
    "llm_short_title": "Full-Stack Engineer",
    "llm_short_duty": "developing web and business applications",
    "llm_short_company_type": "System Integrator",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Kanagawa",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1088219",
    "source": "Daijob",
    "language_en": "Conversational",
    "language_jp": "Conversational",
    "salary_max": 8500000,
    "salary_min": 4500000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.758Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Java": 4,
      "JavaScript": 3,
      "HTML": 4,
      "CSS": 3,
      "Node.js": 0,
      "React": 0,
      "TypeScript": 0,
      "PHP": 0,
      "C": 0,
      "C++": 0,
      "C#": 0,
      "Python": 1,
      "AWS": 0,
      "GCP": 0,
      "Azure": 0
    }
  },
  {
    "id": 286,
    "llm_match_percent": 85,
    "llm_short_title": "Full-stack Engineer",
    "llm_short_duty": "Building web services and business applications",
    "llm_short_company_type": "System Integrator",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Kanagawa",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1087845",
    "source": "Daijob",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 5000000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.777Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Java": 4,
      "HTML": 4,
      "CSS": 3,
      "Javascript": 3,
      "React": 0,
      "Typescript": 0,
      "Node.js": 0,
      "Python": 1,
      "AWS": 0,
      "GCP": 0,
      "Azure": 0
    }
  },
  {
    "id": 291,
    "llm_match_percent": 70,
    "llm_short_title": "Data & AI Project Manager",
    "llm_short_duty": "managing data/AI projects",
    "llm_short_company_type": "Major Japanese",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1473670",
    "source": "Daijob",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 10000000,
    "salary_min": 5500000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.895Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "JavaScript": 0,
      "TypeScript": 0,
      "SQL": 2,
      "Terraform": 0,
      "Cloudformation": 0,
      "Oracle": 2,
      "PostgreSQL": 0,
      "MySQL": 2,
      "Redshift": 0,
      "BigQuery": 0,
      "Azure Databricks": 0,
      "AWS": 0,
      "Google Cloud": 0,
      "Azure": 0,
      "GitHub": 0,
      "GitLab": 0,
      "CodePipeline": 0,
      "Slack": 0,
      "Teams": 0,
      "Docker": 2
    }
  },
  {
    "id": 293,
    "llm_match_percent": 35,
    "llm_short_title": "Front-end developer",
    "llm_short_duty": "Building blockchain web applications",
    "llm_short_company_type": "Telecommunications/Information Services",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1423856",
    "source": "Daijob",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 18000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.951Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "TypeScript": 0,
      "Next.js": 0,
      "React": 0,
      "wagmi": 0,
      "Chakra UI": 0,
      "Go": 0,
      "Rust": 0,
      "Solidity": 0,
      "Kotlin": 0,
      "PostgreSQL": 0,
      "Azure": 0,
      "Kubernetes": 0,
      "GitHub Actions": 0,
      "Argo CD": 0,
      "Argo Workflows": 0,
      "OpenTelemetry": 0,
      "Grafana": 0
    }
  },
  {
    "id": 294,
    "llm_match_percent": 55,
    "llm_short_title": "Site Reliability Engineer",
    "llm_short_duty": "Building and maintaining blockchain infrastructure",
    "llm_short_company_type": "Telecommunications/Information Services",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1423854",
    "source": "Daijob",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 18000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.979Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Go": 0,
      "Rust": 0,
      "Kubernetes": 0,
      "PostgreSQL": 0,
      "Azure": 0,
      "GitHub Actions": 0,
      "Grafana": 0,
      "TypeScript": 0,
      "Next.js": 0
    }
  },
  {
    "id": 295,
    "llm_match_percent": 48,
    "llm_short_title": "Blockchain Backend Engineer",
    "llm_short_duty": "designing and implementing blockchain core infrastructure",
    "llm_short_company_type": "FinTech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1423852",
    "source": "Daijob",
    "language_en": "None",
    "language_jp": "Business",
    "salary_max": 18000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:21.693Z\"",
    "updatedAt": "\"2025-11-20T16:00:13.998Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Go": 0,
      "Rust": 0,
      "Solidity": 0,
      "Kotlin": 0,
      "PostgreSQL": 0,
      "TypeScript": 0,
      "Next.js": 0,
      "Kubernetes": 0,
      "GitHub Actions": 0,
      "Grafana": 0
    }
  },
  {
    "id": 305,
    "llm_match_percent": 25,
    "llm_short_title": "Senior Data Analyst",
    "llm_short_duty": "building data models for real-estate decisions",
    "llm_short_company_type": "Real-Estate Marketplace",
    "llm_remote_percentage": 60,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1464217",
    "source": "Daijob",
    "language_en": "Conversational",
    "language_jp": "Conversational",
    "salary_max": 12000000,
    "salary_min": 8000000,
    "createdAt": "\"2025-11-05T02:06:27.052Z\"",
    "updatedAt": "\"2025-11-20T16:00:18.799Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "SQL": 2,
      "MySQL": 2,
      "PostgreSQL": 0,
      "Snowflake": 0,
      "dbt": 0,
      "Tableau": 0,
      "Google Analytics 4": 0
    }
  },
  {
    "id": 309,
    "llm_match_percent": 42,
    "llm_short_title": "Full-stack Engineer",
    "llm_short_duty": "developing a supplement and skincare lifestyle app",
    "llm_short_company_type": "Telecommunications/Information Services",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1404277",
    "source": "Daijob",
    "language_en": "None",
    "language_jp": "Fluent",
    "salary_max": 8500000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-05T02:06:27.052Z\"",
    "updatedAt": "\"2025-11-20T16:00:18.884Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Git": 4,
      "Jenkins": 4,
      "Firebase": 0,
      "Sonar": 0
    }
  },
  {
    "id": 310,
    "llm_match_percent": 42,
    "llm_short_title": "Backend Engineer",
    "llm_short_duty": "building AI English-learning web services",
    "llm_short_company_type": "EdTech",
    "llm_remote_percentage": 50,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1352556",
    "source": "Daijob",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:27.052Z\"",
    "updatedAt": "\"2025-11-20T16:00:18.904Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Python": 1,
      "Flask": 0,
      "Django": 0,
      "REST": 3,
      "GraphQL": 0,
      "AWS": 0,
      "Linux": 2,
      "RDBMS": 2,
      "Git": 4,
      "Terraform": 0
    }
  },
  {
    "id": 312,
    "llm_match_percent": 45,
    "llm_short_title": "Front-end engineer",
    "llm_short_duty": "developing Vue.js/React front-ends for AI English-learning apps",
    "llm_short_company_type": "EdTech",
    "llm_remote_percentage": 50,
    "remote_partial": false,
    "remote_full": true,
    "location": "Tokyo",
    "source_details_url": "https://www.daijob.com/en/jobs/detail/1353771",
    "source": "Daijob",
    "language_en": "Conversational",
    "language_jp": "Business",
    "salary_max": 12000000,
    "salary_min": 7000000,
    "createdAt": "\"2025-11-05T02:06:27.052Z\"",
    "updatedAt": "\"2025-11-20T16:00:18.941Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Vue.js": 0,
      "React": 0
    }
  },
  {
    "id": 327,
    "llm_match_percent": 15,
    "llm_short_title": "UX/UI Designer",
    "llm_short_duty": "designing user interfaces and user experiences",
    "llm_short_company_type": "HR Tech",
    "llm_remote_percentage": 100,
    "remote_partial": false,
    "remote_full": true,
    "location": "Remote",
    "source_details_url": "https://japan-dev.com/jobs/givery/givery-hr-tech-senior-uxui-designer-k8193n",
    "source": "Japan Dev",
    "language_en": "Business",
    "language_jp": "None",
    "salary_max": 8400000,
    "salary_min": 6000000,
    "createdAt": "\"2025-11-11T17:25:19.494Z\"",
    "updatedAt": "\"2025-11-13T04:00:58.010Z\"",
    "ignored": null,
    "blocked": null,
    "user_notes": null,
    "llm_techs_used": {
      "Figma": 0,
      "Design": 0
    }
  }
];  //Replace this line with Job Postings

jobPostings.sort((a, b) => b.llm_match_percent - a.llm_match_percent);

document.getElementById("timestamp-subheading").textContent =
  "as of " + generationTimestamp.toLocaleString();

document.querySelectorAll(".accordion-header").forEach(h => {
  h.addEventListener("click", () => {
    const target = document.getElementById(h.dataset.target);
    const isOpen = target.style.display === "block";
    target.style.display = isOpen ? "none" : "block";
  });
});


function colorFromPercent(p){
  const r = p<50 ? 255 : Math.round(255 - (p-50)*5.1);
  const g = p>50 ? 255 : Math.round(p*5.1);
  return `rgb(${r},${g},0)`;
}

function colorByLevel(v, invert){
  const colors=["red","orange","yellowgreen","green"];
  const map={"None":0,"Conversational":1,"Business":2,"Fluent":3};
  const invertOffset = invert ? 3 : 0;
  const invertMultiplier = invert ? 1 : -1;
  return colors[(invertOffset - map[v]) * invertMultiplier];
}

function humanReadableAge(createdAt) {
  const now = new Date();
  let diffSeconds = (now - createdAt) / 1000; // seconds

  if (diffSeconds < 60) return `${Math.floor(diffSeconds)} seconds`;
  const diffMinutes = diffSeconds / 60;
  if (diffMinutes < 60) return `${Math.floor(diffMinutes)} minutes`;
  const diffHours = diffMinutes / 60;
  if (diffHours < 24) return `${Math.floor(diffHours)} hours`;
  const diffDays = diffHours / 24;
  if (diffDays < 30) return `${Math.floor(diffDays)} days`;
  const diffMonths = Math.floor(diffDays / 30);
  return `${diffMonths} month${diffMonths > 1 ? "s" : ""}`;
}


function colorByAge(createdAt) {
  const now = new Date();
  const diffDays = (now - createdAt) / (1000 * 60 * 60 * 24); // total days

  if (diffDays >= 30) return "red"; // fully red after 1 month

  let r = 0, g = 0, b = 0;

  if (diffDays <= 15) {
    // green → yellow (0–15 days)
    const t = diffDays / 15; // 0 → 1
    r = Math.round(255 * t);     // R goes 0 → 255
    g = 255;                     // G stays at 255
  } else {
    // yellow → red (15–30 days)
    const t = (diffDays - 15) / 15; // 0 → 1
    r = 255;                       // R stays at 255
    g = Math.round(255 * (1 - t)); // G goes 255 → 0
  }

  return `rgb(${r},${g},${b})`;
}

function renderCardButtons(actions, j, card) {
  actions.innerHTML = ""; // clear previous buttons

  const addButton = (label, handler) => {
    const btn = document.createElement("div");
    btn.className = "action-btn";
    btn.textContent = label;
    btn.onclick = handler;
    actions.appendChild(btn);
  };

  // Always present:
  addButton(`View on ${j.source}`, () =>
    window.open(j.source_details_url, "_blank")
  );
  addButton("Edit Notes", () => {
    overlay.style.display = "flex";
    notesTextarea.value = j.user_notes || "";
    notesTextarea.dataset.cardId = j.id;
  });

  // Current bucket → valid transitions
  if (!j.blocked && !j.ignored) {
    // READY → Waiting, Dismissed
    addButton("Move to Waiting", () => {
      j.blocked = true;
      j.ignored = false;
      moveCard(card, j);
    });
    addButton("Move to Dismissed", () => {
      j.ignored = true;
      j.blocked = false;
      moveCard(card, j);
    });
  } else if (j.blocked) {
    // WAITING → Ready, Dismissed
    addButton("Move to Ready For Review", () => {
      j.blocked = false;
      j.ignored = false;
      moveCard(card, j);
    });
    addButton("Move to Dismissed", () => {
      j.ignored = true;
      j.blocked = false;
      moveCard(card, j);
    });
  } else if (j.ignored) {
    // DISMISSED → Ready, Waiting
    addButton("Move to Ready For Review", () => {
      j.ignored = false;
      j.blocked = false;
      moveCard(card, j);
    });
    addButton("Move to Waiting", () => {
      j.blocked = true;
      j.ignored = false;
      moveCard(card, j);
    });
  }
}


function makeCard(j){
  const card=document.createElement("div");
  card.className="card";
  card.dataset.id = String(j.id);
  card.style.border=`3px solid ${colorFromPercent(j.llm_match_percent)}`;
  card.style.boxShadow=`0 0 12px ${colorFromPercent(j.llm_match_percent)}`;

  const top=document.createElement("div");
  top.className="top-section";

  const loc=document.createElement("div");
  loc.className="circle location-circle";
  let locColor="red",locText=j.location;
  if(j.remote_full){locColor="green";locText="Remote";}
  else if(j.remote_partial){
    if(j.location==="Osaka"){locColor="greenyellow";locText="Osaka (Partial Remote)";}
    else if(["Kyoto","Nara","Sakai","Kobe"].includes(j.location)){locColor="yellow";locText=`${j.location} (Partial Remote)`;}
    else{locColor="red";locText=`${j.location} (Partial Remote)`;}
  }else{
    if(j.location==="Osaka"){locColor="yellow";locText="Osaka";}
    else if(["Kyoto","Nara","Sakai","Kobe"].includes(j.location)){locColor="orange";locText=j.location;}
    else locColor="red";
  }
  loc.style.background=locColor;
  loc.textContent=locText;
  loc.addEventListener("mouseenter",()=>loc.textContent=j.llm_remote_percentage+"%");
  loc.addEventListener("mouseleave",()=>loc.textContent=locText);

  const match=document.createElement("div");
  match.className="circle match-circle";
  match.style.background=colorFromPercent(j.llm_match_percent);
  match.textContent=j.llm_match_percent+"%";
  match.addEventListener("mouseenter",()=>match.textContent=j.id);
  match.addEventListener("mouseleave",()=>match.textContent=j.llm_match_percent+"%");

  const ruler=document.createElement("div");
  ruler.className="salary-ruler";
  for(let i=0;i<=32;i++){
    const mark=document.createElement("div");
    mark.className="mark"+(i%2===0?" major":"");
    mark.style.left=(i/32*100)+"%";
    ruler.appendChild(mark);
    if(i%2===0){
      const label=document.createElement("div");
      label.className="label";
      label.style.left=(i/32*100)+"%";
      label.textContent=(i/2)+"m";
      ruler.appendChild(label);
    }
  }

  const range=document.createElement("div");
  range.className="salary-range";
  const start=(j.salary_min/16000000)*100;
  const end=(j.salary_max/16000000)*100;
    
  range.style.left=start+"%";
  range.style.width=(end-start)+"%";

  if (end <= 50) {
    //All red case
    range.style.background="linear-gradient(to right, rgba(255,0,0,0.4) 0 100%";
  } else if (start >= 50) {
    range.style.background="linear-gradient(to right, rgba(0,255,0,0.4) 0 100%";
  } else {
    const crossover = Math.ceil(((50-start) / (end-start)) * 100);
    range.style.background=`linear-gradient(to right, rgba(255,0,0,0.4) 0 ${crossover}%, rgba(0,200,0,0.4) ${crossover}% 100%)`;
  }
    
  ruler.appendChild(range);

  top.append(loc,match,ruler);

  const mid=document.createElement("div");
  mid.className="middle-section";

      
  const jp=document.createElement("div");

    const jpHeader = document.createElement("div");
    jpHeader.className = "language-header";
    jpHeader.textContent = "JP";
    jp.appendChild(jpHeader);


  jp.className="language-ruler left";
  ["Fluent","Business","Conversational","None"].reverse().forEach(l=>{
    const lbl=document.createElement("div");
    lbl.className="label";
    lbl.textContent=l;
    jp.appendChild(lbl);
  });
  const jpTri=document.createElement("div");
  jpTri.className="triangle";
  const jpLevels=["Fluent","Business","Conversational","None"].reverse();
  const jpLevelsOffsets = [6.5, 36, 66, 95].reverse();
  jpTri.style.top=(jpLevelsOffsets[jpLevels.indexOf(j.language_jp)]+"%");
  jpTri.style.transform="translateY(-50%)";
  jpTri.style.borderRightColor=colorByLevel(j.language_jp, false);
  jp.appendChild(jpTri);

  const center=document.createElement("div");
  center.className="center-info";
  ["llm_short_title","llm_short_duty","llm_short_company_type"].forEach(k=>{
    const d=document.createElement("div");
    d.textContent=j[k];
    center.appendChild(d);
  });

  const en=document.createElement("div");

    const enHeader = document.createElement("div");
enHeader.className = "language-header";
enHeader.textContent = "EN";
en.appendChild(enHeader);

    
  en.className="language-ruler right";
  ["None","Conversational","Business","Fluent"].reverse().forEach(l=>{
    const lbl=document.createElement("div");
    lbl.className="label";
    lbl.textContent=l;
    en.appendChild(lbl);
  });
  const enTri=document.createElement("div");
  enTri.className="triangle";
  const enLevels=["None","Conversational","Business","Fluent"].reverse();
  const enLevelsOffsets = jpLevelsOffsets.reverse();
  enTri.style.top=(enLevelsOffsets[enLevels.indexOf(j.language_en)]+"%");
  enTri.style.transform="translateY(-50%)";
  enTri.style.borderLeftColor=colorByLevel(j.language_en, false);
  en.appendChild(enTri);

  mid.append(jp,center,en);

const ageCircle = document.createElement("div");
ageCircle.className = "circle age-circle";
Date createdDate = new Date(JSON.parse(j.createdAt));
ageCircle.textContent = humanReadableAge(createdDate);
ageCircle.style.background = colorByAge(createdDate);

// on-hover: show full date & time in Japan timezone
ageCircle.addEventListener("mouseenter", () => {
  const d = createdDate;
  const options = { timeZone: "Asia/Tokyo", year: "numeric", month: "2-digit", day: "2-digit" };
  const timeOptions = { timeZone: "Asia/Tokyo", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: false };
  ageCircle.textContent = `${d.toLocaleDateString("en-CA", options)}\n${d.toLocaleTimeString("en-GB", timeOptions)}`;
});

ageCircle.addEventListener("mouseleave", () => {
  ageCircle.textContent = humanReadableAge(createdDate);
  ageCircle.style.background = colorByAge(createdDate); // refresh color in case time passed
});


  const bottomTechs=document.createElement("div");
  bottomTechs.className="bottom-techs";
  for(const [tech,v] of Object.entries(j.llm_techs_used)){
    const t=document.createElement("span");
    t.className="tech";
    const colors=["red","orange","yellow","yellowgreen","green"];
    t.style.color=colors[v];
    t.textContent=tech;
    bottomTechs.appendChild(t);
  }


    const bottomSection = document.createElement("div");
    bottomSection.className = "bottom-section";
    bottomSection.style.position = "relative"; // if needed
    
    // append ageCircle and bottom-techs into this section
    bottomSection.appendChild(ageCircle);
    bottomSection.appendChild(bottomTechs);
    


    // Create bottom buttons container
// Create bottom buttons container
const actions = document.createElement("div");
actions.className = "card-actions";

// Render the correct buttons depending on state
renderCardButtons(actions, j, card);



  
    card.append(top, mid, bottomSection, actions);
  return card;
}

const readySection = document.getElementById("section-ready");
const waitingSection = document.getElementById("section-waiting");
const dismissedSection = document.getElementById("section-dismissed");

jobPostings.forEach(j => {
  const card = makeCard(j);
  if (j.ignored === true) { insertCardSorted(dismissedSection, card, j); }
  else if (j.blocked === true) { insertCardSorted(waitingSection, card, j); }
  else { insertCardSorted(readySection, card, j); }
});

function insertCardSorted(section, card, j) {
  // Get current children as array
  const children = Array.from(section.children);

  // Find insertion point: first child whose job's llm_match_percent < j.llm_match_percent
  let inserted = false;
  for (let existingEl of children) {
    const existingId = existingEl.dataset?.id;
    if (!existingId) continue;
    const existingJob = jobPostings.find(x => String(x.id) === String(existingId));
    if (!existingJob) continue;

    if (existingJob.llm_match_percent < j.llm_match_percent) {
      section.insertBefore(card, existingEl);
      inserted = true;
      break;
    }
  }

  // If nothing found, append to end
  if (!inserted) {
    section.appendChild(card);
  }
}


function moveCard(card, j) {
  // remove card from its current parent if present
  if (card.parentElement) {
    card.parentElement.removeChild(card);
  }

  // decide destination
  let dest;
  if (j.ignored === true) {
    dest = dismissedSection;
  } else if (j.blocked === true) {
    dest = waitingSection;
  } else {
    dest = readySection;
  }

  // insert it into dest in sorted position
  insertCardSorted(dest, card, j);

  // refresh the card's buttons (in case labels/available actions changed)
  const actionsEl = card.querySelector(".card-actions");
  if (actionsEl) {
    renderCardButtons(actionsEl, j, card);
  }
}




    const overlay = document.getElementById("overlay-notes");
const notesTextarea = document.getElementById("notes-textarea");
document.getElementById("save-note").onclick = () => {
  const cardId = parseInt(notesTextarea.dataset.cardId);
  const cardData = jobPostings.find(j => j.id === cardId);
  cardData.user_notes = notesTextarea.value;
  overlay.style.display = "none";
};
document.getElementById("cancel-note").onclick = () => {
  overlay.style.display = "none";
};

// --- ACCORDION LOGIC ---

function setupAccordion(id, startOpen) {
  const acc = document.getElementById(id);
  const header = acc.querySelector(".accordion-header");
  const content = acc.querySelector(".accordion-content");

  // initial state
  content.style.display = startOpen ? "block" : "none";

  header.addEventListener("click", () => {
    content.style.display = (content.style.display === "none") ? "block" : "none";
  });
}

setupAccordion("section-ready", true);     // open by default
setupAccordion("section-waiting", false);
setupAccordion("section-dismissed", false);


</script>
</body>
</html>